[Unit]
Description=Mini-SOC Host-Based Detection Engine
After=network.target systemd-journald.service

[Service]
Type=simple
User=mini-soc
Group=adm
WorkingDirectory=/opt/mini-soc
ExecStart=/opt/mini-soc/.venv/bin/python main.py
Restart=always
RestartSec=10
Environment=PYTHONUNBUFFERED=1

# Security hardening
NoNewPrivileges=true
PrivateTmp=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/opt/mini-soc

[Install]
WantedBy=multi-user.target
